# 创建数组

## 命令创建数组

事实上Powershell会把文本按每一行作为元素存为数组。如果一个命令的返回值不止一个结果时，Powershell也会自动把结果存储为数组。

```
PS C:\Users\wujiashuai> $ipcfg=ipconfig
PS C:\Users\wujiashuai> $ipcfg -is [array]
True
```

而上面的这种方式其实也是判断是否是为数组

## 创建数组

在Powershell中创建数组可以使用逗号。

```
 $nums=1,2,3,4,5
```

连续的数字

```
PS C:Powershell> $nums=1..5
```

象变量一样如果数组中元素的类型为弱类型，默认可以存储不同类型的值。

```
PS C:Powershell> $array=1,"2012世界末日",([System.Guid]::NewGuid()),(get-date)
```

### 特殊数组

#### 空数组和单元素数组

空数组

```
PS C:Powershell> $a=@()
PS C:Powershell> $a -is [array]
True
PS C:Powershell> $a.Count
0
```

1个元素的数组

```
PS C:Powershell> $a=,"moss"
PS C:Powershell> $a -is [array]
True
PS C:Powershell> $a.Count
1
```



## 复制数组

数组属于引用类型，使用默认的的赋值运算符在两个变量之间赋值只是复制了一个引用，两个变量共享同一份数据。这样的模式有一个弊病如果其中一个改变也会株连到另外一个。所以复制数组最好使用Clone()方法，除非有特殊需求。

```
PS C:Powershell> $chsNew=$chs.Clone()
```





#  访问数组

## 选择单个元素

数组的元素可以使用索引寻址，第一个元素的索引为0，第i个元素的索引为i-1，但是，也可以直接可以将 -1 作为最后的一个元素的索引。

```
PS C:Powershell> $books="元素1","元素2","元素3"
PS C:Powershell> $books[0]
元素1
PS C:Powershell> $books[1]
元素2
PS C:Powershell> $books[($book.Count-1)]
元素3
PS C:Powershell> $books[-1]
元素3
```

## 选择多个元素

```
PS C:Powershell> $result=ls
PS C:Powershell> $result[0,3,5,12]
    Directory: C:Powershell

Mode                LastWriteTime     Length Name
----                -------------     ------ ----
d----        2011/11/23     17:25            ABC
-a---        2011/11/24     20:04      26384 a.txt
-a---        2011/11/24     20:27      12060 alias.ps1
-a---        2011/11/24     17:37       7420 name.html
```



# 数组添加和删除元素

因为Powershell数组在内存中是顺序存储的，所以数组的大小必须是确定的，这样才方便分配存储空间，所以给数组增加元素其实相当于创建一个新的数组，只不过之后会把原来的副本删除。在当前数组追加元素可以使用“+=”操作符。

```
PS C:Powershell> $books="元素1","元素2","元素3"
PS C:Powershell> $books+="元素4"
PS C:Powershell> $books
元素1
元素2
元素3
元素4
```




# 管道过滤

如果，你的数组，你需要对他进行一些过滤，只留下你想要留下的，那么就可以·使用管道符。

```
PS C:Powershell> ipconfig | Select-String "IP"

Windows IP Configuration
   Link-local IPv6 Address . . . . . : ***
   IPv4 Address. . . . . . . . . . . : ***
   Link-local IPv6 Address . . . . . : ***
```





对于任何一个对象都可以使用Format-List * 查看它所有的属性和方法。

